import"../chunks/DsnmJJEf.js";import"../chunks/BYui9kYh.js";import{o as h}from"../chunks/BWHUfV-9.js";import{p as l,f as m,b as g,c as _,d as w,r as b}from"../chunks/CiTjGTXK.js";import{e as v}from"../chunks/DLdq7FL_.js";import{i as k}from"../chunks/CfwyDKc0.js";import{s as y,a as $,g as z,i as A,b as H}from"../chunks/CL3qtmpU.js";async function B(t,e){const o=await fetch(t,e),a=o.headers.get("Authorization");if(a){const r=a.replace("Bearer ","");y(r)}return o}async function E(){const t=$(),e=new Headers;return t&&e.set("Authorization",`Bearer ${t}`),await(await B(`${z()}/user_info`,{method:"GET",headers:e})).json()}var L=m("<div><button>登录</button></div>");function D(t,e){l(e,!1);function o(){return window.crypto.randomUUID()}function a(){if(!A)return;const n=["width=640","height=800","left=100","top=100","popup=yes"].join(","),d=`${H()}/auth/github_authorization`,p=o(),f="Iv23li5ddAgUBsPLMdVi";addEventListener("message",r),window.open(`https://github.com/login/oauth/authorize?client_id=${f}&redirect_uri=${d}&state=${p}`,"_blank",n)}function r(n){n.data.type==="authenticated"?console.log("认证成功"):console.log("认证失败：",n.data.error_code,n.data.error),removeEventListener("message",r)}let s=null;async function c(){s=await E(),console.log(s,";;;;;;;;;;;;;")}h(()=>{c()}),k();var i=L(),u=w(i);b(i),v("click",u,a),g(t,i),_()}export{D as component};
